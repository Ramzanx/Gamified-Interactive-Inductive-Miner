<div class="summary-card">
    <h2>Game Completed!</h2>

    <div class="summary-section">
        <h3>Game Performance</h3>
        <div class="summary-item"><span class="label">Total Stages:</span><span class="value">{{ totalStages }}</span>
        </div>
        <div class="summary-item"><span class="label">Total Time:</span><span class="value">{{ this.formatMs(totalTime) || 0 }}</span>
        </div>
        <div class="summary-item"><span class="label">Points Earned:</span><span class="value">{{ totalPointsEarned }}</span>
        </div>
        <div class="summary-item"><span class="label">Grade:</span><span class="value">{{ grade }}</span>
        </div>
    </div>

    <div class="summary-section">
        <h3>Rewards</h3>
        <div class="summary-item"><span class="label">EXP Earned:</span><span class="value">{{ expEarned }}</span></div>
        
    </div>

    <!-- Expand/Collapse Button -->
    <div class="summary-section toggle-stage-header" (click)="toggleStageDetails()">
        <h4 style="cursor: pointer;">
            Stage Details
            <span class="toggle-icon">{{ showStageDetails ? '‚ñ≤' : '‚ñº' }}</span>
        </h4>
    </div>

    <!-- Conditionally show stage details -->
    <div class="summary-section stage-times" *ngIf="showStageDetails && stageTimes?.length">
        <div class="stage-time-grid">
            <div class="stage-time-header">
                <div>Stage</div>
                <div>Time</div>
                <div>Points</div>
            </div>
            <div class="stage-time-item" *ngFor="let time of stageTimes; let i = index">
                <span class="stage-index">Stage {{ i + 1 }}</span>
                <span [ngClass]="getTimeClass(time)" class="stage-duration">{{ this.formatMs(stageTimes[i]) || 0 }} sec</span>
                <span class="stage-points">{{ stagePointsEarned[i] || 0 }} pts</span>
            </div>
        </div>
    </div>


    <button class="play-again-btn" (click)="onPlayAgain()">üîÅ Play Again</button>
</div>